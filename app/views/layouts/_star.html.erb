<script>
document.addEventListener('turbolinks:load', function() {
  document.querySelectorAll('[id^="post_raty_"]').forEach(function(elem) {
    if (!elem.classList.contains('raty-applied')) { // JavaScriptが適用されていない場合のみ適用する
      let rating = elem.dataset.star;
      let opt = {
        starOn: "<%= asset_path('star-on.png') %>",
        starOff: "<%= asset_path('star-off.png') %>",
        starHalf: "<%= asset_path('star-half.png') %>",
        half: true,
        readOnly: true,
        score: rating // ここで評価データを設定
      };
      raty(elem, opt);
      elem.classList.add('raty-applied'); // 適用済みフラグを追加
    }
  });
});
</script>